<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>[助]客户注册</title>
	<?php $SRC = HOME_SRC; ?>
	<script type="text/javascript" src="{$SRC}/scripts/jquery.min.js"></script>
</head>
<body>

	<include file= "./home"/>

	帮助客户填写信息注册
	<form action="{:U('Home/Client/reg')}" method="post">
		<p>姓　名：<input type="text" name="name">*</p>
		<p>身份证：<input id="ID" type="text" name="ID" value="{$ID}" onblur="checkID()">* <span id="ID_tips" style="color:red"></span></p>
		<p>学生证：<input type="text" name="stu_id"></p>
		<p>性　别：<input type="radio" name="sex" value="1">男<input type="radio" name="sex" value="0">女</p>
		<p>手　机：<input type="text" name="phone">*</p>
		<p>验证码：<input type="text" name="verify">
		<img id="verifyImg" src="__URL__/verify/<?php echo NOW_TIME;?>" onClick="changeVerify()" title="点击刷新验证码"/></p>
		<input type="submit" value="注册" />
	</form>
	

	<script language="JavaScript">

		var info_url = "{:U('Home/Client/getPeopleInfo')}";
		var order_url = "{:U('Home/Client/order')}";

		/* 加载入住人信息 */
		function checkID() {
			
			var ID = $("#ID");
			var ID_TIPS = $("#ID_tips");

			if (ID.val().length != 18) {
				ID_TIPS.text("身份证长度不正确！应为18位！");
				ID.focus();
				return;
			};


			$.ajax({
	        	url: info_url,
	        	type: 'post',
	        	data: {ID: ID.val()},
	        	dataType: 'json',
	        	success: function(data) {

	        		if (data['info'] === false) {
	        			ID_TIPS.text("身份证不合法！请检查是否输入正确！");
	        			ID.focus();
	        			return;
	        		};

	        		if (data['info']) {
	        			// ID_TIPS.text("<a href='"+ order_url +"'>直接下单</a>");
	        			ID_TIPS.html('<span id="ID_tips" style="color:red">该身份证已注册！<a href="'+order_url+'?id='+ ID.val() +'">直接下单</a></span>');
	        			// ID.focus();
	        		}else{
	        			ID_TIPS.text("");
	        		}
	        	}
	        });
		}

		function changeVerify(){
			var timenow = new Date().getTime();
			document.getElementById('verifyImg').src='__URL__/verify/'+timenow;
		}
	</script>
	
</body>
</html>